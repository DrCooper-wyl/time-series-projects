library(forecast)
mydata<-read.table("mydata.csv")
y=mydata[,1]
plot(1:161,y,xlim=c(0,170),ylim=c(20,100))
lines(1:161,y,type="l")
par(mfrow=c(1,2))
acf(y)
pacf(y)
#lines(1:161, y-fit$residuals,type="l",col="red")
z=diff(y)
dev.off()
plot(1:160,z,xlim=c(0,170),ylim=c(-10,10))
lines(1:160,z,type="l")
par(mfrow=c(1,2))
acf(z)
pacf(z)
fit=arima(y,order=c(0,1,6))
tsdiag(fit)
fit
forecast=predict(fit,n.ahead=10)
futurVal=forecast(fit,h=10,level=c(90))
dev.off()
plot(futurVal)
lines(1:161,y,type="o")
lines(1:161, y-fit$residuals, type="l", col="red")
lines(162:171,forecast$pred,type="o",col="red")
lines(162:171,forecast$pred-1.645*forecast$se,col="blue")
lines(162:171,forecast$pred+1.645*forecast$se,col="blue")
