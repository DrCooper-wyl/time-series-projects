#fit trend model
n=20;
t=1:n;
y=c(15.91,9.8,17.16,16.68,15.53,22.66,31.01,8.62,45.82,10.97,45.46,28.69,36.75,37.75,41.18,42.67,46.05,43.7,53.08,47.56);
x=matrix(c(rep(1,n),1:n),n,2);
t(x)%*%x
t(x)%*%y
beta=solve(t(x)%*%x)%*%(t(x)%*%y)
beta
err=y-x%*%beta
d=sum((err[1:19]-err[2:20])^2)/sum(err^2)
d
r=sum((err[1:19]*err[2:20]))/sum(err^2)
r
y1=y[2:20]-r*y[1:19]
x1=matrix(c(rep(1,n-1),2:n),n-1,2)-r*matrix(c(rep(1,n-1),1:(n-1)),n-1,2)
t(x1)%*%x1
t(x1)%*%y1
beta1=solve(t(x1)%*%x1)%*%(t(x1)%*%y1)
beta1
err1=y1-x1%*%beta1
d1=sum((err1[1:18]-err1[2:19])^2)/sum(err1^2)
r1=sum((err1[1:18]*err[2:19]))/sum(err1^2)
d1
r1
err1


#fit trend model
n=12;
t=1:n;
y=c(4.26,5.03,5.97,7.95,8.8,13.3,13.96,18.2,19.36,22.87,23.65,27.7);
x=matrix(c(rep(1,n),1:n,(1:n)^2),n,3);
u=solve(t(x)%*%x)
t(x)%*%y
beta=solve(t(x)%*%x)%*%(t(x)%*%y)
beta
x%*%beta
err=y-x%*%beta
s=sqrt(sum(err^2)/(n-3))
d=sum((err[1:11]-err[2:12])^2)/sum(err^2)
d
sd=c(s*sqrt(u[1,1]),s*sqrt(u[2,2]),s*sqrt(u[3,3]))
sd
rsquare=1-sum(err^2)/sum((y-mean(y))^2)
rsquare
F=(sum((x%*%beta-mean(y))^2)/(3-1))/(sum(err^2)/(n-3))
F
beta/(sd)

#International Airline Passengers
n=20;
t=1:n;
y=c(878,1005,1173,883,972,1125,1336,988,1020,1146,1400,1006,1108,1288,1570,1174,1227,1468,1736,1283);
z=log(y);
x=matrix(c(rep(1,n),1:n,rep(c(1,0,0,0),5),0,rep(c(1,0,0,0),4),1,0,0,0,0,rep(c(1,0,0,0),4),1,0),n,5);
u=solve(t(x)%*%x)
t(x)%*%x
beta=solve(t(x)%*%x)%*%(t(x)%*%z)
beta
x%*%beta
err=z-x%*%beta
s=sqrt(sum(err^2)/(n-5))
s
d=sum((err[1:19]-err[2:20])^2)/sum(err^2)
d
sd=c(s*sqrt(u[1,1]),s*sqrt(u[2,2]),s*sqrt(u[3,3]),s*sqrt(u[4,4]),s*sqrt(u[5,5]))
sd
sse=sum(err^2)
sse
sst=sum((z-mean(z))^2)
sst
ssr=sum((x%*%beta-mean(z))^2)
ssr
rsquare=1-sse/sst
rsquare
F=(sum((x%*%beta-mean(z))^2)/(5-1))/(sum(err^2)/(n-5))
F
beta/(sd)

n=20;
t=1:n;
y=c(878,1005,1173,883,972,1125,1336,988,1020,1146,1400,1006,1108,1288,1570,1174,1227,1468,1736,1283);
x=matrix(c(rep(1,n),1:n,rep(c(1,0,0,0),5),0,rep(c(1,0,0,0),4),1,0,0,0,0,rep(c(1,0,0,0),4),1,0,1,rep(0,3),5,rep(0,3),
           9,rep(0,3),13,rep(0,3),17,rep(0,3),0,2,rep(0,3),6,rep(0,3),10,rep(0,3),14,rep(0,3),18,rep(0,4),3,rep(0,3),7,rep(0,3),
           11,rep(0,3),15,rep(0,3),19,0),n,8);
u=solve(t(x)%*%x)
t(x)%*%x
beta=solve(t(x)%*%x)%*%(t(x)%*%y)
beta
x%*%beta
err=y-x%*%beta
s=sqrt(sum(err^2)/(n-8))
s^2
d=sum((err[1:19]-err[2:20])^2)/sum(err^2)
d
sd=c(s*sqrt(u[1,1]),s*sqrt(u[2,2]),s*sqrt(u[3,3]),s*sqrt(u[4,4]),s*sqrt(u[5,5]),s*sqrt(u[6,6]),s*sqrt(u[7,7]),s*sqrt(u[8,8]))
sd
sse=sum(err^2)
sse
sst=sum((y-mean(y))^2)
sst
ssr=sum((x%*%beta-mean(y))^2)
ssr
rsquare=1-sse/sst
rsquare
F=(sum((x%*%beta-mean(y))^2)/(8-1))/(sum(err^2)/(n-8))
F
t(abs(beta)/(sd))

#simplified model
n=20;
t=1:n;
y=c(878,1005,1173,883,972,1125,1336,988,1020,1146,1400,1006,1108,1288,1570,1174,1227,1468,1736,1283);
x=matrix(c(rep(1,n),1:n,0,rep(c(1,0,0,0),4),1,0,0,0,0,rep(c(1,0,0,0),4),1,0,rep(0,2),3,rep(0,3),7,rep(0,3),
           11,rep(0,3),15,rep(0,3),19,0),n,5);
u=solve(t(x)%*%x)
t(x)%*%x
beta=solve(t(x)%*%x)%*%(t(x)%*%y)
beta
t1=x%*%beta
err=y-x%*%beta
s=sqrt(sum(err^2)/(n-8))
s^2
d=sum((err[1:19]-err[2:20])^2)/sum(err^2)
d
sd=c(s*sqrt(u[1,1]),s*sqrt(u[2,2]),s*sqrt(u[3,3]),s*sqrt(u[4,4]),s*sqrt(u[5,5]))
sd
sse=sum(err^2)
sse
sst=sum((y-mean(y))^2)
sst
ssr=sum((x%*%beta-mean(y))^2)
ssr
rsquare=1-sse/sst
rsquare
F=(sum((x%*%beta-mean(y))^2)/(8-1))/(sum(err^2)/(n-8))
F
t(abs(beta)/(sd))
plot(t,y, type="o",xlim=c(1,n),ylim=c(800,2000),col=2,xlab="",ylab="")
par(new=T)
plot(t,t1,type="o",xlim=c(1,n),ylim=c(800,2000),axes=F,col=3,xlab="time quarter",ylab="no. of passengers")