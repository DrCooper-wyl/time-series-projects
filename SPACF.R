#SPACF
z=c(3.91, 3.86, 3.81, 3.02, 2.62, 1.89, -1.13, -3.82, -5.08, -4.42, -1.99,
    0.70, 1.86, 2.98, 1.78, 3.01, 2.13, 3.23, 3.17, 4.64, 5.20, 6.76, 5.79, 5.08, 1.88, -0.72,
    -2.00, -3.03, -2.35, -3.34, -3.21, -3.57, -4.28, -3.54, -3.16, -1.41, 0.48, 1.61, 2.42, 2.11,
    2.45, 1.39, 2.04, 1.71, 3.26, 3.20, 1.43, 1.68, 4.17, 4.75);
n=length(z);
par(mfrow=c(1,4))
plot(1:n,z,type="l",xlim=c(1,n),ylim=c(-7,7))
acf(z)
pacf(z)
x1=matrix(c(rep(1,n-2),z[2:(n-1)],z[1:(n-2)]),n-2,3);
y=z[3:n];
u=solve(t(x1)%*%x1)
beta1=u%*%(t(x1)%*%y)
beta1
fit1=x1%*%beta1
plot(3:n,z[3:50],type="l",xlim=c(1,n),ylim=c(-7,7),col=1)
par(new=T)
plot(3:n,fit1,type="b",xlim=c(1,n),ylim=c(-7,7),col=2)

fit=arima(z,order=c(2,0,0))
fit
beta2=matrix(c(1.3621*(1-1.3734+0.5233),1.3734,-0.5233),3,1);
fit2=x1%*%beta2
par(new=T)
plot(3:n,fit2,type="b",xlim=c(1,n),ylim=c(-7,7),col=4)

E1=t(z[3:n]-fit1)%*%(z[3:n]-fit1)
E2=t(z[3:n]-fit2)%*%(z[3:n]-fit2)
E1
E2
predict(fit,n.ahead=5)
tsdiag(fit)
library(astsa)
sarima(z,2,0,0)

# MA(1)
z=c(-0.3771, -0.7009, -0.6063, -2.1099, -2.0939, -0.6972, -0.8131, -0.4401, 0.0068, 0.0498, 0.5552, -0.3333, -2.3981, -1.9854, -1.3579, 0.6725, 2.0068, 2.4630, 1.8879, -0.2878, -1.2468, 0.5062, 1.5715, 2.7983, 0.8574, 0.1626, 0.6390, 0.2969, 0.3278, 0.6458)
arima(z,0,0,1)
sarima(z,0,0,1)