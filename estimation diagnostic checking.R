x=c(-1.30, -0.18, 0.94, -0.26, -1.05, -0.78,-0.82, 0.43, 0.57, 1.41, -1.47, 0.49, 0.00, -0.15, -0.64, 0.24, -0.79, 0.82, -0.20, -0.80,
    -0.22, 0.88, -0.75, 0.55, 0.73, -0.82, 0.70, -1.54, 0.04, -0.70, -0.58, -1.38, -1.28, 0.49, -0.76, 1.08, 0.16, 1.11, -0.06, 0.88, 0.89, 0.31, 0.03,-1.19, -0.38, 0.49, 1.02, -0.98, 0.50, -0.57)
acf(x)
pacf(x)
fit=arima(x, order=c(1,0,1))
tsdiag(fit)
p=predict(fit,n.ahead=10)
p$pred
p$se

x=c(5.05, 5.02, 4.78, 4.73, 4.86,4.81, 4.86, 4.74, 4.89, 5.03, 5.13, 5.16, 5.19, 5.13, 5.16, 5.10, 5.04, 5.07, 4.95, 4.91)
uhat=mean(x)
x=x-uhat
acf=acf(x)
phi=acf$acf[2]
dhat=(1-phi)*uhat


library(matlib) 
x=c(0.15, -0.06, -0.39,-0.56, -0.52, -0.26, -0.11, 0.32, 0.31, 0.01, 0.00, 0.17, 0.52, 0.32, -0.08, -0.30, -0.16,0.32, 0.29, 0.07)
acf=acf(x)
r1=acf$acf[2]
r2=acf$acf[3]
A=matrix(c(1,r1,r1,1),2,2)
b=c(r1,r2)
sol=Solve(A,b)


x=c(1.25, 1.64, 1.78, 1.33, 1.21, 1.04, 1.04, 1.55, 1.31, 0.89, 0.78, 1.28,1.79, 2.42, 2.09, 1.57, 1.05, 0.97, 1.26, 1.70)
uhat=mean(x)
x=x-uhat
acf=acf(x)
r1=acf$acf[2]
r2=acf$acf[3]
A=matrix(c(1,r1,r1,1),2,2)
b=c(r1,r2)
sol=Solve(A,b)

y=c(-0.89, -0.53,  0.54, -0.26, -1.34, -1.97, -0.35,  0.46, -0.08, -1.13,  0.04,  1.64,   1.95,  0.94, -0.11,  0.18,  0.72,  0.91, -1.09, 0.12,  1.29,  0.79,  1.67, -0.60,  -1.72, -0.76, -2.60, -1.71, -0.39, -1.18)
yhat=mean(y)
z=y-yhat
acf=acf(z)
acf[1] # or acf$acf[2]

x=c(0.50, -0.41, 0.37, -0.61,  0.23, -0.13,  0.06, -0.11,  0.18, -0.14,  0.20, 0.09, -0.03, -0.02, -0.14, -0.07,  0.09,  0.09, -0.01,  -0.10)
par(mfrow=c(2,1))
acf(x)
pacf(x)